<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<meta name="author" content="ifdef::backend-revealjs[]">
<meta name="copyright" content="Timothy Pratley">
<title>Term Rewriting with Meander</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="shortcut icon" type="image/x-icon" href="img/clojure-logo-icon-32.png">
</head>
<body class="article">
<link rel="shortcut icon" type="image/x-icon" href="../img/clojure-logo-icon-32.png">
<div id="header">
<h1>Term Rewriting with Meander</h1>
<div class="details">
<span id="author" class="author">ifdef::backend-revealjs[]</span><br>
<span id="revdate">endif</span>
<br><span id="revremark">:[]</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>As a programmer, my job is to write the function to transform inputs to outputs.</p>
</div>
<div class="stemblock">
<div class="content">
\[f(x) = x + 1\]
</div>
</div>
<div class="paragraph">
<p>Usually the inputs and outputs are complex data that represent something in the real world.
Abstractly though, I tend to think about the inputs and outputs as data shapes.
Squares go in, circles come out.
Defining functions is my fundamental form of expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/fx.png" alt="processing machine">
</div>
<div class="title">Figure 1. The square to circle machine &#8482;</div>
</div>
<div class="paragraph">
<p>As a mathematician, <em>equations</em> are my fundamental form of expression.
Equations define valid rules for transforming one expression into another.
My job is to solve problems using symbolic manipulation.</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align*}
(a + b)^2 &amp;= (a + b)(a + b)\\
          &amp;= aa + ab + ba + bb\\
          &amp;= a^2 + 2ab + b^2
\end{align*}\]
</div>
</div>
<div class="paragraph">
<p>Functions and equations are both fine ways to specify transformations.
So why only use functions for programming?
What does it look like to program data transformation like equations instead of functions?
Today we will look at some examples of an equation base approach to specifying data transformations.
Before diving into the examples, let&#8217;s first establish some definitions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definitions">Definitions</h2>
<div class="sectionbody">
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Term rewriting
</td>
<td class="hdlist2">
<p><em>Replacing terms with other terms</em></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Term
</td>
<td class="hdlist2">
<p><em>A variable or function application:</em> \(a\), \((a + b)\), \((a + b)^2\)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Variable
</td>
<td class="hdlist2">
<p>\(a,b\) can be assigned a value</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Function
</td>
<td class="hdlist2">
<p><code>add</code>, <code>multiply</code>, <code>square</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Rule
</td>
<td class="hdlist2">
<p><em>A pair of matching terms and substitution terms:</em> \((a + b)^2 =&gt; a^2 + 2ab + b^2\)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Matching
</td>
<td class="hdlist2">
<p>\((1 + 3)^2\) <em>can be made equal to</em> \((a + b)^2\) <em>when</em> \(a=1,b=3\)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Substitution
</td>
<td class="hdlist2">
<p><em>Creation of new terms from old ones</em> \((1 + 3)^2 =&gt; 1^2 + 2\cdot1\cdot3 + 2^2\)</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Term rewriting allows any transformation.
Math equations are rules that strictly preserve equivalence.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introducing_meander">Introducing Meander</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Meander is a term rewriting system packaged as a Clojure library for data transformation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">[meander/epsilon <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0.0.512</span><span style="color:#710">&quot;</span></span>]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">ns</span> <span style="color:#707;font-weight:bold">meander.examples</span>
  (<span style="color:#A60">:require</span> [meander.epsilon <span style="color:#A60">:as</span> m]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>I prefer to call it a <em>structural pattern syntax</em> for data transformation.</p>
</div>
<div class="sect2">
<h3 id="_rewrite">Rewrite</h3>
<div class="paragraph">
<p>The <code>m/rewrite</code> macro is the swiss army knife of Meander.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s do our first transformation from a vector to a map:</p>
</div>
<div class="stemblock">
<div class="content">
\[[a, b, c, d] =&gt; \{a, d\}\]
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure"><span style="color:#777">; Meander!</span>
(m/rewrite [<span style="color:#A60">:a</span> <span style="color:#00D">1</span> <span style="color:#A60">:c</span> <span style="color:#00D">2</span>] <span style="color:#777">; input</span>
  [?a ?b ?c ?d]        <span style="color:#777">; a match pattern</span>
  {?a ?d})             <span style="color:#777">; a substitution pattern</span>

<span style="color:#777">;=&gt; {:a 2 :c 1}             ; output</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>match pattern</em> is a data literal with the shape of the input</p>
</li>
<li>
<p>The <em>substitution pattern</em> is a data literals with the shape of the output</p>
</li>
<li>
<p><code>?a</code> is called a <em>logic variable</em></p>
</li>
<li>
<p>You can also use <code>_</code> for unused terms</p>
</li>
</ul>
</div>
<div class="admonitionblock note speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>?x</code> is a valid symbol in Clojure.
Macros manipulate symbols rather than the values associated with those symbols. <code>m/rewrite</code> is a macro; it defines how to interpret the patterns.
I think of Meander as a syntax because I specify structure with data literals to pattern match and substitute.
Hence why I prefer to call it a "structural pattern syntax".</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_logic">Logic</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#00D">1</span> <span style="color:#00D">2</span>] <span style="color:#777">; input</span>
  [?a ?a]        <span style="color:#777">; a match pattern</span>
  {?a ?a})       <span style="color:#777">; a substitute pattern</span>

<span style="color:#777">;=&gt; nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>No match.</p>
</div>
<div class="paragraph">
<p><code>?a</code> cannot match both <code>1</code> and <code>2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#00D">1</span> <span style="color:#00D">1</span>] <span style="color:#777">; input</span>
  [?a ?a]        <span style="color:#777">; a match</span>
  {?a ?a})       <span style="color:#777">; a substitution pattern</span>

<span style="color:#777">;=&gt; {1 1}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Matched <code>?a</code> with <code>1</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unification means resolving logical matches.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_repeating_terms">Repeating terms</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#A60">:a</span> <span style="color:#00D">1</span> <span style="color:#A60">:c</span> <span style="color:#00D">2</span> <span style="color:#A60">:d</span> <span style="color:#00D">3</span>]
  [!a <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]
  [!a <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>])

<span style="color:#777">;=&gt; [:a 1 :c 2 :d 3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>!a</code> is a memory variable: <em>an array that can collect many values</em><br>
<code>&#8230;&#8203;</code> indicates 0 or more repeated occurrences</p>
</div>
<div class="admonitionblock note speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The match pattern is symmetrical with the substitution pattern.
We got out exactly what we put in.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_repeat_scope">Repeat scope</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#00D">1</span> <span style="color:#A60">:a</span> <span style="color:#00D">2</span> <span style="color:#A60">:b</span> <span style="color:#00D">3</span> <span style="color:#A60">:c</span>]
  [!x !y <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]      <span style="color:#777">; match pairs</span>
  [!y !x <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>])     <span style="color:#777">; substitute flipped pairs</span>

<span style="color:#777">;=&gt; [:a 1 :b 2 :c 3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All terms preceeding <code>&#8230;&#8203;</code> repeat.</p>
</div>
</div>
<div class="sect2">
<h3 id="_separator">Separator</h3>
<div class="paragraph">
<p>Limits the scope of repeats.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#A60">:hello</span> <span style="color:#00D">1</span> <span style="color:#00D">2</span> <span style="color:#00D">3</span>]
  [<span style="color:#A60">:hello</span> <span style="color:#080;font-weight:bold">.</span> !v <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]
  [<span style="color:#A60">:world</span> <span style="color:#080;font-weight:bold">.</span> !v <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>])

<span style="color:#777">;=&gt; [:world 1 2 3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the terms between <code>.</code> and <code>&#8230;&#8203;</code> repeat.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structurally_explicit">Structurally explicit</h3>
<div class="paragraph">
<p>Most Clojure functions will coerce their inputs to seqs.
Meander does not do this.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>[!x &#8230;&#8203;]</code>
</td>
<td class="hdlist2">
<p>will only match <strong>vectors</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>(!x &#8230;&#8203;)</code>
</td>
<td class="hdlist2">
<p>will only match <strong>lists</strong> and <strong>seqs</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>{:k ?v}</code>
</td>
<td class="hdlist2">
<p>will only match <strong>maps</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>#{1}</code>
</td>
<td class="hdlist2">
<p>will only match <strong>sets</strong></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>(m/seqable !x &#8230;&#8203;)</code>
</td>
<td class="hdlist2">
<p>will match <strong>maps</strong>, <strong>vectors</strong>, <strong>strings</strong>, etc&#8230;&#8203;</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>I like that it will only match the same types unless you choose to be more permissive with <code>m/seqable</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nesting">Nesting</h3>
<div class="paragraph">
<p>As you might expect, match and substitute patterns may be nested.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite {<span style="color:#A60">:xs</span> [<span style="color:#00D">1</span> <span style="color:#00D">2</span> <span style="color:#00D">3</span> <span style="color:#00D">4</span> <span style="color:#00D">5</span>]
            <span style="color:#A60">:ys</span> [<span style="color:#00D">6</span> <span style="color:#00D">7</span> <span style="color:#00D">8</span> <span style="color:#00D">9</span> <span style="color:#00D">10</span>]}
  {<span style="color:#A60">:xs</span> [!xs <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]
   <span style="color:#A60">:ys</span> [!ys <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]}
  [!xs <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> <span style="color:#080;font-weight:bold">.</span> !ys <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>])

<span style="color:#777">;=&gt; [1 2 3 4 5 6 7 8 9 10]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And Meander does the rearranging for you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pop_quiz">Pop Quiz</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(m/rewrite [<span style="color:#A60">:hello</span> <span style="color:#00D">1</span> <span style="color:#00D">2</span> <span style="color:#00D">3</span>]
  [?k <span style="color:#080;font-weight:bold">.</span> !v <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>]
  [?k !v <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>])

<span style="color:#777">;=&gt; [:hello 1 :hello 2 :hello 3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Why?</p>
</div>
<div class="admonitionblock note speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When matching, we expect a single value, then repeated values.
The substituting pattern has no separator, so we are substituting pairs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Congratulations!
Enjoy these macarons as your reward.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/macarons.png" alt="Delicious macarons">
</div>
</div>
<div class="paragraph">
<p>Meander has a rich feature set.
I have only shown you the core syntax.
We are now going to shift gears and look at some examples in the wild.
I&#8217;ll introduce a few bits of unexplained but fairly obvious syntax as we go.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a comprehensive treatment of Meander features, see <a href="https://github.com/noprompt/meander">Meander on GitHub</a> which links to documentation, a cookbook, blog posts and a Strange Loop talk.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rearranging_logic_expressions">Rearranging logic expressions</h3>
<div class="paragraph">
<p>This example is taken from <a href="https://github.com/timothypratley/justice">Justice</a> (an alternative syntax to Datalog queries). <a href="https://github.com/timothypratley/justice/blob/master/src/justice/translation.cljc">source</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">rearrange-logic</span>
  (bottom-up
   <span style="color:#777">;; nested commutative logic is raised</span>
   ((m/pred #{'<span style="color:#080;font-weight:bold">and</span> '<span style="color:#080;font-weight:bold">or</span>} ?op) <span style="color:#080;font-weight:bold">.</span> !before <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> (?op <span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>) <span style="color:#080;font-weight:bold">.</span> !after <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)
   (?op <span style="color:#080;font-weight:bold">.</span> !before <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> !after <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)

   <span style="color:#777">;; moves `or` to the outside,</span>
   <span style="color:#777">;; and `and` to the inside to match Datalog rule convention</span>
   (<span style="color:#080;font-weight:bold">and</span> <span style="color:#080;font-weight:bold">.</span> !before <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> (<span style="color:#080;font-weight:bold">or</span> <span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>) <span style="color:#080;font-weight:bold">.</span> !after <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)
   (<span style="color:#080;font-weight:bold">or</span> <span style="color:#080;font-weight:bold">.</span> (<span style="color:#080;font-weight:bold">and</span> <span style="color:#080;font-weight:bold">.</span> ~@!before <span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">.</span> ~@!after) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)

   <span style="color:#777">;; identity logic expressions are flattened</span>
   ((m/pred #{'<span style="color:#080;font-weight:bold">and</span> '<span style="color:#080;font-weight:bold">or</span>} ?op) ?body)
   ?body

   <span style="color:#777">;; double negatives are removed</span>
   (<span style="color:#080;font-weight:bold">not</span> (<span style="color:#080;font-weight:bold">not</span> ?body))
   ?body

   <span style="color:#777">;; moves `not` inside to match Datalog rule convention</span>
   (<span style="color:#080;font-weight:bold">not</span> (<span style="color:#080;font-weight:bold">or</span> <span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>))
   (<span style="color:#080;font-weight:bold">and</span> <span style="color:#080;font-weight:bold">.</span> (<span style="color:#080;font-weight:bold">not</span> !clauses) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)

   (<span style="color:#080;font-weight:bold">not</span> (<span style="color:#080;font-weight:bold">and</span> <span style="color:#080;font-weight:bold">.</span> !clauses <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>))
   (<span style="color:#080;font-weight:bold">or</span> <span style="color:#080;font-weight:bold">.</span> (<span style="color:#080;font-weight:bold">not</span> !clauses) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_web_scraping">Web scraping</h3>
<div class="paragraph">
<p>This example comes from the <a href="https://github.com/timothypratley/chartit">Chartit</a> (an ETL/analytics utility for tracking work)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">extract-employees</span>
  (s/search
   (m/$
    [<span style="color:#A60">:div</span> {<span style="color:#A60">:class</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">directory-tables</span><span style="color:#710">&quot;</span></span>} &amp;
     (m/scan
      <span style="color:#777">;; heading/table pairs</span>
      [<span style="color:#A60">:h3</span> {} ?department &amp; _]
      _
      [<span style="color:#A60">:table</span> &amp;
       (m/scan
        [<span style="color:#A60">:tbody</span> &amp;
         (m/scan
          [<span style="color:#A60">:tr</span> &amp;
           (m/separated
            [<span style="color:#A60">:td</span> &amp; (m/scan [<span style="color:#A60">:a</span> {} ?name &amp; _])]
            [<span style="color:#A60">:td</span> {} ?title &amp; _]
            [<span style="color:#A60">:td</span> &amp; (m/scan [<span style="color:#A60">:a</span> {<span style="color:#A60">:href</span> ?mailto} &amp; _])])])])])])
   <span style="color:#777">;;=&gt;</span>
   {<span style="color:#A60">:department</span> (str/trim ?department)
    <span style="color:#A60">:name</span> ?name
    <span style="color:#A60">:title</span> ?title
    <span style="color:#A60">:email</span> (<span style="color:#080;font-weight:bold">subs</span> ?mailto <span style="color:#00D">7</span>)}))</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/timothypratley/chartit/blob/master/src/chartit/justworks.clj">source</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_parsing_defn_like_forms">Parsing defn like forms</h3>
<div class="paragraph">
<p>Here is another example from <a href="https://github.com/timothypratley/justice">Justice</a>.
where it was desirable to define a macro that behaves like <code>defn</code>.
This example can be directly compared with <a href="https://blog.klipse.tech/clojure/2016/10/10/defn-args.html">the Clojure.spec approach</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">defn</span> <span style="color:#06B;font-weight:bold">wrap-defn</span>
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Returns a function that will parse a form according to `defn` semantics.
  Takes a function which will convert fn-spec forms.</span><span style="color:#710">&quot;</span></span>
  [rewrite-fn-spec]
  (m/rewrite
   (m/and ((pred simple-symbol? ?name) <span style="color:#080;font-weight:bold">.</span>
           (pred <span style="color:#080;font-weight:bold">string?</span> !?docstring) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>
           (pred <span style="color:#080;font-weight:bold">map?</span> !?attr-map) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>
           !tail <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)
        (m/guard (<span style="color:#080;font-weight:bold">&lt;=</span> (<span style="color:#080;font-weight:bold">count</span> !?docstring) <span style="color:#00D">1</span>))
        (m/guard (<span style="color:#080;font-weight:bold">&lt;=</span> (<span style="color:#080;font-weight:bold">count</span> !?attr-map) <span style="color:#00D">1</span>))
        (<span style="color:#080;font-weight:bold">let</span>
         (<span style="color:#080;font-weight:bold">or</span> (([(m/pred simple-symbol? !params) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> <span style="color:#A60">:as</span> !param-list] <span style="color:#080;font-weight:bold">.</span> !forms <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> <span style="color:#A60">:as</span> !fn-specs) <span style="color:#080;font-weight:bold">..</span><span style="color:#00D">1</span>)
             ([(m/pred simple-symbol? !params) <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> <span style="color:#A60">:as</span> !param-list] <span style="color:#080;font-weight:bold">.</span> !forms <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> <span style="color:#A60">:as</span> !fn-specs))
          (<span style="color:#080;font-weight:bold">list*</span> !tail))
        (m/guard (<span style="color:#080;font-weight:bold">apply</span> <span style="color:#080;font-weight:bold">distinct?</span> (<span style="color:#080;font-weight:bold">map</span> <span style="color:#080;font-weight:bold">count</span> !param-list))))
   <span style="color:#777">;;&gt;</span>
   (<span style="color:#080;font-weight:bold">defn</span> <span style="color:#06B;font-weight:bold">?name</span> <span style="color:#080;font-weight:bold">.</span> !?docstring <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span> !?attr-map <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>
     ~@(<span style="color:#080;font-weight:bold">map</span> rewrite-fn-spec !fn-specs))))</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/timothypratley/justice/blob/master/src/justice/defn.cljc">source</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_schema_to_code">Schema to code</h3>
<div class="paragraph">
<p>This example shows the core functionality of <a href="https://github.com/timothypratley/happygapi">HappyGAPI</a> (a library that exposes Google APIs by generating code from schemas).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">defn</span> <span style="color:#06B;font-weight:bold">summarize-schema</span> [schema request depth]
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Given a json-schema of type definitions,
  and a request that is a $ref to one of those types,
  resolves $ref(s) to a depth of 3,
  discards the distracting information,
  and returns a pattern for constructing the required input.</span><span style="color:#710">&quot;</span></span>
  (m/rewrite request
    {<span style="color:#A60">:type</span>                 <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">object</span><span style="color:#710">&quot;</span></span>
     <span style="color:#A60">:id</span>                   ?id
     <span style="color:#A60">:additionalProperties</span> ?ap
     <span style="color:#A60">:properties</span>           (m/seqable [!property !item] <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)}
    <span style="color:#777">;;&gt;</span>
    {&amp; ([!property (m/app #(summarize-schema schema % depth) !item)] <span style="color:#080;font-weight:bold">..</span><span style="color:#080;font-weight:bold">.</span>)}

    {<span style="color:#A60">:type</span>  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">array</span><span style="color:#710">&quot;</span></span>
     <span style="color:#A60">:items</span> ?item}
    <span style="color:#777">;;&gt;</span>
    [~(summarize-schema schema ?item depth)]

    {<span style="color:#A60">:type</span> (m/pred <span style="color:#080;font-weight:bold">string?</span> ?type)}
    <span style="color:#777">;;&gt;</span>
    (m/app <span style="color:#080;font-weight:bold">symbol</span> ?type)

    {<span style="color:#A60">:$ref</span> (m/pred <span style="color:#080;font-weight:bold">string?</span> ?ref)}
    <span style="color:#777">;;&gt;</span>
    ~(<span style="color:#080;font-weight:bold">if</span> (<span style="color:#080;font-weight:bold">&gt;</span> depth <span style="color:#00D">2</span>)
       (<span style="color:#080;font-weight:bold">symbol</span> ?ref)
       (summarize-schema schema (<span style="color:#080;font-weight:bold">get</span> schema (<span style="color:#080;font-weight:bold">keyword</span> ?ref)) (<span style="color:#080;font-weight:bold">inc</span> depth)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/timothypratley/happygapi/blob/master/dev/happy/beaver.clj">source</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_ast_manipulation">AST manipulation</h3>
<div class="paragraph">
<p>This example comes from <a href="https://github.com/echeran/kalai">Kalai</a>, a transpiler from Clojure to Java and Rust.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="clojure">(<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">propagate-types-from-bindings-to-locals</span>
  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">We propagate type information which is stored in metadata
  from the the place where they are declared on a symbol
  to all future usages of that symbol in scope.</span><span style="color:#710">&quot;</span></span>
  (s/rewrite
    {<span style="color:#A60">:op</span>   <span style="color:#A60">:local</span>
     <span style="color:#A60">:form</span> ?symbol
     <span style="color:#A60">:env</span>  {<span style="color:#A60">:locals</span> {?symbol {<span style="color:#A60">:form</span> ?symbol-with-meta
                              <span style="color:#A60">:init</span> ?init}}
            <span style="color:#A60">:as</span>     ?env}
     &amp;     ?more
     <span style="color:#A60">:as</span>   ?ast}
    <span style="color:#777">;;&gt;</span>
    {<span style="color:#A60">:op</span>   <span style="color:#A60">:local</span>
     <span style="color:#A60">:form</span> ~(propagate-ast-type ?init ?symbol-with-meta ?ast)
     <span style="color:#A60">:env</span>  ?env
     &amp;     ?more}

    <span style="color:#777">;; otherwise leave the ast as is</span>
    ?else
    ?else))</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/echeran/kalai/blob/main/src/kalai/pass/kalai/b_kalai_constructs.clj">source</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_patterns_vs_functions">Reading patterns vs functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Those were all pretty complicated transformations.<br>
<em>Could you follow them?</em><br>
I bet it was easier than most code.<br>
<em>Is that normal?</em><br>
I claim that term rewriting expressions are much easier to read than functional transformations.</p>
</div>
<div class="paragraph">
<p>Next let&#8217;s compare what is involved in writing functions vs patterns.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_functions_vs_patterns">Writing functions vs patterns</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_functions_are_like_recipes">Functions are like recipes</h3>
<div class="paragraph">
<p>Functions are all about what to do with inputs.</p>
</div>
<div class="paragraph">
<p>Clearly the big difference between functions and rewrite rules is what to do with the inputs.
To write a function is to specify in verbiage the tasks in order to convert the ingredients into the desired meal.
This is a verbal description of how to transform inputs to outputs in written form.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/recipe.png" alt="Recipe">
</div>
<div class="title">Figure 2. A recipe for making beef stew</div>
</div>
</div>
<div class="sect2">
<h3 id="_recipe_for_a_function">Recipe for a function</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1. Prepare meat and potatoes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(example inputs)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2. Mix ingredients in a pot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(function definition)</em><br>
- A little destructuring<br>
- a dash of <code>let</code> binding<br>
- some sequence seasoning <code>for</code> flavor<br>
- a teaspoon of <code>conj</code>, <code>update</code>, and <code>assoc</code><br>
- a splash of threading</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3. Boil</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(iterate, make it work)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4. Garnish with documentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(docstring or types)</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5. Simmer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(tests)</em></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Easy to forget why it tastes good<br>
Easy to skip documentation and testing</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_patterns_are_more_like_pictures">Patterns are more like pictures</h3>
<div class="paragraph">
<p>Rewrite rules are the inputs and outputs; the <em>what to do</em> part is completely missing.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/stew.png" alt="Pot of stew">
</div>
<div class="title">Figure 3. A hearty pot of beef stew</div>
</div>
</div>
<div class="sect2">
<h3 id="_picturing_a_pattern">Picturing a pattern</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1. Prepare example inputs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[{:k "Meat"} {:k "Potatoes"}]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2. Parameterize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[{:k !ingredient} &#8230;&#8203;]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3. Recombine as outputs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[!ingredient &#8230;&#8203; "Stew"]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4. Create a test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(is (= [] (stew example)))</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5. Verify the output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>["Meat" "Potatoes" "Stew"]</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note speaker">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Examples are the best kind of documentation.
Writing Meander feels like writing examples.
It gives me confidence I solved the right problem, and it&#8217;s easy to see what it does coming back to it later.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_data_transformation">Data transformation</h3>
<div class="paragraph">
<p>When should we use term rewriting instead of functions?</p>
</div>
<div class="paragraph">
<p>Term rewriting is suitable for largish data reshaping where you would otherwise do destructuring, updates, restructuring, and pipelines.</p>
</div>
<div class="openblock speaker">
<div class="content">
<div class="paragraph">
<p>Why isn&#8217;t this the default way of writing code everywhere?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Term rewriting systems are hard to implement, and rarely integrated with programming languages.</p>
</li>
<li>
<p>Functions are far more familiar in the programming community.</p>
</li>
<li>
<p>Limitations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What&#8217;s the catch?</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_limitations">Limitations</h3>
<div class="sect3">
<h4 id="_extension">Extension</h4>
<div class="paragraph">
<p>The syntax available in data literals is limited by the host language.
Meander syntax is partially extensible through <code>defsyntax</code> to define custom operators.
Execution extension is available by function application (see <code>m/app</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_failure_to_match_is_opaque">Failure to match is opaque</h4>
<div class="paragraph">
<p>Similar to regular expressions, it can be difficult to figure out why a match isn&#8217;t made for a given input.
Simplifying and decomposing can help.
Function application can be used <code>(m/app #(doto % prn) ?x)</code> to spy on terms.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reduction">Reduction</h4>
<div class="paragraph">
<p>Meander has recursion, so you can reduce.
But recursion has no syntactic advantage.
The next branch of Meander (zeta) contains a neater way to express reduction.</p>
</div>
</div>
<div class="sect3">
<h4 id="_memory_variable_correspondence">Memory variable correspondence</h4>
<div class="paragraph">
<p>Nested memory variables in a single expression can get confusing.
There is potential for a syntactic simplification <a href="https://github.com/noprompt/meander/issues/129">issue#129</a>.
The next branch of Meander (zeta) has flexibility in how variables behave, which may solve this.</p>
</div>
</div>
<div class="sect3">
<h4 id="_performance">Performance</h4>
<div class="paragraph">
<p>On par with hand rolled functions.
Meander is a high quality library: fast and reliable.</p>
</div>
</div>
<div class="sect3">
<h4 id="_decomposition">Decomposition</h4>
<div class="paragraph">
<p>The current options for creating sub-patterns are <code>m/with</code> and <code>m/app</code>.
This is equivalent to functional decomposition.
I wish for a more syntactically elegant approach.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comparing_meander">Comparing Meander</h3>
<div class="paragraph">
<p>How does Meander compare to other data transformation approaches in Clojure?</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<a href="https://clojure.github.io/clojure/#clojure.core">Clojure.core</a>
</td>
<td class="hdlist2">
<p>Clojure is concise and powerful.
Many functions defined on few primary data structures.
We operate on data but do not specify what the data is.
So it is common to be looking at a function that operates on <code>x</code>, and have no context about what <code>x</code> aught to be.
What is <code>x</code>?</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://clojure.org/guides/destructuring">Destructuring</a>
</td>
<td class="hdlist2">
<p>Does one job well.
No logic expressions or substitution.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/clojure/core.match">Core.match</a>, <a href="https://github.com/clojure/core.logic">Core.logic</a>
</td>
<td class="hdlist2">
<p>Independently work great. There is no convenient syntax for substitution.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://clojure.org/guides/spec">Clojure.spec</a>
</td>
<td class="hdlist2">
<p>Defines the shape of <code>x</code> as s-expression regexes.
Specs do not look like the data they describe.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<a href="https://github.com/redplanetlabs/specter">Specter</a>
</td>
<td class="hdlist2">
<p>Takes a navigator/action approach.
Improves data manipulation.
Does not address shape.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="openblock speaker">
<div class="content">
<div class="paragraph">
<p>The mathematical style term rewriting approach to data transformation has several merits:</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>When reading expressions, inputs and outputs are instantly recognizable</p>
</li>
<li>
<p>When writing expressions, examples can be converted to patterns</p>
</li>
<li>
<p>The declarative style is symmetrically pleasing</p>
</li>
<li>
<p>Visual expression is more effective than verbal expression</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Meander provides term rewriting as a convenient library for Clojure.
I hope you will give it a try and find it as useful as I have.</p>
</div>
<div class="paragraph">
<p>Thank you for reading.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-06-19 11:12:51 -0700
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css">
<script>
    window.klipse_settings = {
        selector: '.eval-clojure'// css selector for the html elements you want to klipsify
    };
</script>
<script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js"></script>
<script>
    Reveal.addEventListener( 'slidechanged', function() {
        window.dispatchEvent(new Event('resize'));
    } );
</script>
</body>
</html>